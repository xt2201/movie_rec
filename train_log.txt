â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Movie Recommendation Training â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Configuration â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ model:                                          â”‚
â”‚   name: lightgcn                                â”‚
â”‚   type: graph                                   â”‚
â”‚   embedding_dim: 64                             â”‚
â”‚   num_layers: 3                                 â”‚
â”‚   dropout: 0.0                                  â”‚
â”‚   add_self_loops: False                         â”‚
â”‚   normalize: True                               â”‚
â”‚   loss_type: bpr                                â”‚
â”‚ data:                                           â”‚
â”‚   name: movielens_small                         â”‚
â”‚   files: {'ratings':                            â”‚
â”‚ 'movielens-small/ratings.csv', 'movies':        â”‚
â”‚ 'movielens-small/movies.csv', 'links':          â”‚
â”‚ 'movielens-small/links.csv', 'tags':            â”‚
â”‚ 'movielens-small/tags.csv'}                     â”‚
â”‚   preprocessing: {'min_rating': 3.0,            â”‚
â”‚ 'min_user_interactions': 5,                     â”‚
â”‚ 'min_item_interactions': 5}                     â”‚
â”‚   split: {'strategy': 'random', 'train_ratio':  â”‚
â”‚ 0.8, 'val_ratio': 0.1, 'test_ratio': 0.1}       â”‚
â”‚   temporal: {'timestamp_col': 'timestamp'}      â”‚
â”‚   leave_one_out: {'num_test_items': 1,          â”‚
â”‚ 'num_val_items': 1}                             â”‚
â”‚   negative_sampling: {'num_negatives': 4,       â”‚
â”‚ 'strategy': 'uniform'}                          â”‚
â”‚   dataloader: {'batch_size': 1024,              â”‚
â”‚ 'num_workers': 4, 'pin_memory': True,           â”‚
â”‚ 'shuffle': True}                                â”‚
â”‚   graph: {'undirected': True, 'add_self_loops': â”‚
â”‚ False}                                          â”‚
â”‚ trainer:                                        â”‚
â”‚   name: default                                 â”‚
â”‚   max_epochs: 2                                 â”‚
â”‚   learning_rate: 0.001                          â”‚
â”‚   weight_decay: 1e-05                           â”‚
â”‚   batch_size: 1024                              â”‚
â”‚   optimizer: {'name': 'adam', 'betas': [0.9,    â”‚
â”‚ 0.999], 'eps': 1e-08}                           â”‚
â”‚   scheduler: {'name': 'reduce_on_plateau',      â”‚
â”‚ 'mode': 'min', 'factor': 0.5, 'patience': 5,    â”‚
â”‚ 'min_lr': 1e-06}                                â”‚
â”‚   early_stopping: {'enabled': True, 'patience': â”‚
â”‚ 10, 'min_delta': 0.0001, 'monitor': 'val_loss', â”‚
â”‚ 'mode': 'min'}                                  â”‚
â”‚   gradient_clip: {'enabled': True, 'max_norm':  â”‚
â”‚ 1.0}                                            â”‚
â”‚   checkpoint: {'enabled': True, 'save_top_k':   â”‚
â”‚ 3, 'monitor': 'val_loss', 'mode': 'min',        â”‚
â”‚ 'save_last': True}                              â”‚
â”‚   val_check_interval: 1                         â”‚
â”‚   mixed_precision: False                        â”‚
â”‚   detect_anomaly: False                         â”‚
â”‚ logger:                                         â”‚
â”‚   name: wandb_mlflow                            â”‚
â”‚   use_mlflow: True                              â”‚
â”‚   use_wandb: True                               â”‚
â”‚   use_rich: True                                â”‚
â”‚   wandb: {'project': 'movie-rec', 'entity':     â”‚
â”‚ None, 'name': 'lightgcn_2025-12-16_15-35-24',   â”‚
â”‚ 'tags': ['lightgcn', 'movielens_small'],        â”‚
â”‚ 'notes': None, 'mode': 'online', 'log_model':   â”‚
â”‚ True, 'watch_model': True, 'watch_log':         â”‚
â”‚ 'gradients', 'watch_freq': 100}                 â”‚
â”‚   mlflow: {'tracking_uri':                      â”‚
â”‚ '/home/thanhnx/movie_rec/mlruns',               â”‚
â”‚ 'experiment_name': 'movie_recommendation',      â”‚
â”‚ 'run_name': 'lightgcn_2025-12-16_15-35-24',     â”‚
â”‚ 'log_model': True, 'register_model': False,     â”‚
â”‚ 'registered_model_name': 'lightgcn'}            â”‚
â”‚   rich: {'show_progress': True, 'show_table':   â”‚
â”‚ True, 'refresh_rate': 10}                       â”‚
â”‚   log_every_n_steps: 50                         â”‚
â”‚   log_every_n_epochs: 1                         â”‚
â”‚   metrics: {'train': ['loss', 'learning_rate'], â”‚
â”‚ 'val': ['loss', 'precision_at_10',              â”‚
â”‚ 'recall_at_10', 'ndcg_at_10',                   â”‚
â”‚ 'hit_rate_at_10']}                              â”‚
â”‚ experiment_name: movie_recommendation           â”‚
â”‚ project_name: movie-rec                         â”‚
â”‚ run_name: lightgcn_2025-12-16_15-35-24          â”‚
â”‚ seed: 42                                        â”‚
â”‚ device: cuda                                    â”‚
â”‚ paths:                                          â”‚
â”‚   data_dir: /home/thanhnx/movie_rec/data        â”‚
â”‚   output_dir: /home/thanhnx/movie_rec/outputs   â”‚
â”‚   checkpoint_dir:                               â”‚
â”‚ /home/thanhnx/movie_rec/checkpoints             â”‚
â”‚   mlflow_dir: /home/thanhnx/movie_rec/mlruns    â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Using device: cuda
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Loading Data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ“ Loaded 608 users, 3,012 items
âœ“ Train: 57,921 interactions
âœ“ Val: 7,240 interactions
âœ“ Test: 7,241 interactions
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Building Model â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ“ Built LightGCN(num_users=608, num_items=3012, 
embedding_dim=64, params=231,680)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Training â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
/home/thanhnx/.local/lib/python3.13/site-packages/mlflow/tracking/_tracking_service/utils.py:177: FutureWarning: The filesystem tracking backend (e.g., './mlruns') will be deprecated in February 2026. Consider transitioning to a database backend (e.g., 'sqlite:///mlflow.db') to take advantage of the latest MLflow features. See https://github.com/mlflow/mlflow/issues/18534 for more details and migration guidance.
  return FileStore(store_uri, store_uri)
wandb: Currently logged in as: xt2201-vht (xt2201-vht-hust) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: WARNING Using a boolean value for 'reinit' is deprecated. Use 'return_previous' or 'finish_previous' instead.
wandb: setting up run 32965dra
wandb: Tracking run with wandb version 0.23.0
wandb: Run data is saved locally in /home/thanhnx/movie_rec/wandb/run-20251216_153527-32965dra
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lightgcn_2025-12-16_15-35-24
wandb: â­ï¸ View project at https://wandb.ai/xt2201-vht-hust/movie-rec
wandb: ğŸš€ View run at https://wandb.ai/xt2201-vht-hust/movie-rec/runs/32965dra
â•­â”€â”€â”€â”€â”€â”€â”€ Experiment: movie_recommendation â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ model:                                          â”‚
â”‚   name: lightgcn                                â”‚
â”‚   type: graph                                   â”‚
â”‚   embedding_dim: 64                             â”‚
â”‚   num_layers: 3                                 â”‚
â”‚   dropout: 0.0                                  â”‚
â”‚   add_self_loops: False                         â”‚
â”‚   normalize: True                               â”‚
â”‚   loss_type: bpr                                â”‚
â”‚ data:                                           â”‚
â”‚   name: movielens_small                         â”‚
â”‚   files: {'ratings':                            â”‚
â”‚ 'movielens-small/ratings.csv', 'movies':        â”‚
â”‚ 'movielens-small/movies.csv', 'links':          â”‚
â”‚ 'movielens-small/links.csv', 'tags':            â”‚
â”‚ 'movielens-small/tags.csv'}                     â”‚
â”‚   preprocessing: {'min_rating': 3.0,            â”‚
â”‚ 'min_user_interactions': 5,                     â”‚
â”‚ 'min_item_interactions': 5}                     â”‚
â”‚   split: {'strategy': 'random', 'train_ratio':  â”‚
â”‚ 0.8, 'val_ratio': 0.1, 'test_ratio': 0.1}       â”‚
â”‚   temporal: {'timestamp_col': 'timestamp'}      â”‚
â”‚   leave_one_out: {'num_test_items': 1,          â”‚
â”‚ 'num_val_items': 1}                             â”‚
â”‚   negative_sampling: {'num_negatives': 4,       â”‚
â”‚ 'strategy': 'uniform'}                          â”‚
â”‚   dataloader: {'batch_size': 1024,              â”‚
â”‚ 'num_workers': 4, 'pin_memory': True,           â”‚
â”‚ 'shuffle': True}                                â”‚
â”‚   graph: {'undirected': True, 'add_self_loops': â”‚
â”‚ False}                                          â”‚
â”‚ trainer:                                        â”‚
â”‚   name: default                                 â”‚
â”‚   max_epochs: 2                                 â”‚
â”‚   learning_rate: 0.001                          â”‚
â”‚   weight_decay: 1e-05                           â”‚
â”‚   batch_size: 1024                              â”‚
â”‚   optimizer: {'name': 'adam', 'betas': [0.9,    â”‚
â”‚ 0.999], 'eps': 1e-08}                           â”‚
â”‚   scheduler: {'name': 'reduce_on_plateau',      â”‚
â”‚ 'mode': 'min', 'factor': 0.5, 'patience': 5,    â”‚
â”‚ 'min_lr': 1e-06}                                â”‚
â”‚   early_stopping: {'enabled': True, 'patience': â”‚
â”‚ 10, 'min_delta': 0.0001, 'monitor': 'val_loss', â”‚
â”‚ 'mode': 'min'}                                  â”‚
â”‚   gradient_clip: {'enabled': True, 'max_norm':  â”‚
â”‚ 1.0}                                            â”‚
â”‚   checkpoint: {'enabled': True, 'save_top_k':   â”‚
â”‚ 3, 'monitor': 'val_loss', 'mode': 'min',        â”‚
â”‚ 'save_last': True}                              â”‚
â”‚   val_check_interval: 1                         â”‚
â”‚   mixed_precision: False                        â”‚
â”‚   detect_anomaly: False                         â”‚
â”‚ logger:                                         â”‚
â”‚   name: wandb_mlflow                            â”‚
â”‚   use_mlflow: True                              â”‚
â”‚   use_wandb: True                               â”‚
â”‚   use_rich: True                                â”‚
â”‚   wandb: {'project': 'movie-rec', 'entity':     â”‚
â”‚ None, 'name': 'lightgcn_2025-12-16_15-35-24',   â”‚
â”‚ 'tags': ['lightgcn', 'movielens_small'],        â”‚
â”‚ 'notes': None, 'mode': 'online', 'log_model':   â”‚
â”‚ True, 'watch_model': True, 'watch_log':         â”‚
â”‚ 'gradients', 'watch_freq': 100}                 â”‚
â”‚   mlflow: {'tracking_uri':                      â”‚
â”‚ '/home/thanhnx/movie_rec/mlruns',               â”‚
â”‚ 'experiment_name': 'movie_recommendation',      â”‚
â”‚ 'run_name': 'lightgcn_2025-12-16_15-35-24',     â”‚
â”‚ 'log_model': True, 'register_model': False,     â”‚
â”‚ 'registered_model_name': 'lightgcn'}            â”‚
â”‚   rich: {'show_progress': True, 'show_table':   â”‚
â”‚ True, 'refresh_rate': 10}                       â”‚
â”‚   log_every_n_steps: 50                         â”‚
â”‚   log_every_n_epochs: 1                         â”‚
â”‚   metrics: {'train': ['loss', 'learning_rate'], â”‚
â”‚ 'val': ['loss', 'precision_at_10',              â”‚
â”‚ 'recall_at_10', 'ndcg_at_10',                   â”‚
â”‚ 'hit_rate_at_10']}                              â”‚
â”‚ experiment_name: movie_recommendation           â”‚
â”‚ project_name: movie-rec                         â”‚
â”‚ run_name: lightgcn_2025-12-16_15-35-24          â”‚
â”‚ seed: 42                                        â”‚
â”‚ device: cuda                                    â”‚
â”‚ paths:                                          â”‚
â”‚   data_dir: /home/thanhnx/movie_rec/data        â”‚
â”‚   output_dir: /home/thanhnx/movie_rec/outputs   â”‚
â”‚   checkpoint_dir:                               â”‚
â”‚ /home/thanhnx/movie_rec/checkpoints             â”‚
â”‚   mlflow_dir: /home/thanhnx/movie_rec/mlruns    â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Model Summary â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Model: LightGCN                                 â”‚
â”‚ Parameters: 231,680                             â”‚
â”‚ Trainable: 231,680                              â”‚
â”‚ Users: 608                                      â”‚
â”‚ Items: 3,012                                    â”‚
â”‚ Embedding Dim: 64                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

        Epoch 0 Results         
â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ Metric â”ƒ  Train â”ƒ Validation â”ƒ
â”¡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ loss   â”‚ 0.6866 â”‚     0.6668 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

        Epoch 1 Results         
â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ Metric â”ƒ  Train â”ƒ Validation â”ƒ
â”¡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ loss   â”‚ 0.6105 â”‚     0.5522 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Training â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 2/2 â€¢ 0:00:01 â€¢ 0:00:00
wandb: updating run metadata
wandb: uploading output.log; uploading wandb-summary.json
wandb: uploading history steps 0-1, summary, console lines 17-115
wandb: 
wandb: Run history:
wandb: learning_rate â–â–
wandb:    train/loss â–ˆâ–
wandb:      val/loss â–ˆâ–
wandb: 
wandb: Run summary:
wandb: learning_rate 0.001
wandb:    train/loss 0.61055
wandb:      val/loss 0.5522
wandb: 
wandb: ğŸš€ View run lightgcn_2025-12-16_15-35-24 at: https://wandb.ai/xt2201-vht-hust/movie-rec/runs/32965dra
wandb: â­ï¸ View project at: https://wandb.ai/xt2201-vht-hust/movie-rec
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251216_153527-32965dra/logs
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Evaluation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Evaluating model...
Evaluation:   0%|          | 0/3 [00:00<?, ?it/s]Evaluation:  33%|â–ˆâ–ˆâ–ˆâ–      | 1/3 [00:00<00:00,  3.81it/s]Evaluation:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  4.61it/s]Evaluation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.83it/s]
   Evaluation Results    
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
â”ƒ Metric       â”ƒ  Value â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
â”‚ hit_rate@10  â”‚ 0.4395 â”‚
â”‚ hit_rate@20  â”‚ 0.5588 â”‚
â”‚ hit_rate@5   â”‚ 0.3322 â”‚
â”‚ ndcg@10      â”‚ 0.1025 â”‚
â”‚ ndcg@20      â”‚ 0.1125 â”‚
â”‚ ndcg@5       â”‚ 0.1007 â”‚
â”‚ precision@10 â”‚ 0.0741 â”‚
â”‚ precision@20 â”‚ 0.0597 â”‚
â”‚ precision@5  â”‚ 0.0876 â”‚
â”‚ recall@10    â”‚ 0.0855 â”‚
â”‚ recall@20    â”‚ 0.1321 â”‚
â”‚ recall@5     â”‚ 0.0533 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
âœ“ Saved model to 
/home/thanhnx/movie_rec/checkpoints/final_model.pt
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Training Complete! â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
